<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="Hello World!">
<meta property="og:type" content="website">
<meta property="og:title" content="qicainiao&#39;s Blog">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="qicainiao&#39;s Blog">
<meta property="og:description" content="Hello World!">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="qicainiao&#39;s Blog">
<meta name="twitter:description" content="Hello World!">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/2/">





  <title>qicainiao's Blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">qicainiao's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/08/28/webpack系列/13webpack中tree shaking/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="qicainiao">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="qicainiao's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/28/webpack系列/13webpack中tree shaking/" itemprop="url">webpack系列-13webpack中 tree shaking概念详解</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-08-28T14:50:26+08:00">
                2019-08-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>index.js</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import <span class="string">"@babel/polyfill"</span>;</span><br></pre></td></tr></table></figure>

<p>index.js里面只留下babel/plyfill。打包npm run bundle，会发现一条提示语。<br>他的意思是如果.babelrc里面用了useBuiltIns。业务代码里面就不需要再引入babel/polyfill。webpack会自动引入polyfill。<br>将index.js里面的代码全部删除就没有问题了。在src里面新建一个math.js</p>
<p>math.js</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> const add = (a, b) =&gt; &#123;</span><br><span class="line">　　console.log(a+b);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> const minus = (a, b) =&gt; &#123;</span><br><span class="line">　　console.log(a-b);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>index.js</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import &#123; add &#125; from <span class="string">'./math.js'</span>;</span><br><span class="line"></span><br><span class="line">add(1,2);</span><br></pre></td></tr></table></figure>

<p>index.html</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"en"</span>&gt;</span><br><span class="line">　　&lt;head&gt;</span><br><span class="line">　　　　&lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">　　　　&lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span><br><span class="line">　　　　&lt;meta http-equiv=<span class="string">"X-UA-Compatible"</span> content=<span class="string">"ie=edge"</span>&gt;</span><br><span class="line">　　　　&lt;title&gt;html template&lt;/title&gt;</span><br><span class="line">　　&lt;/head&gt;</span><br><span class="line">　　&lt;body&gt;</span><br><span class="line">　　　　&lt;div id=<span class="string">'root'</span>&gt;&lt;/div&gt;</span><br><span class="line">　　&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>所有文件准备好了后，我们打包npx webpack。打开index.html。就发现输出了3。说明代码已经正确的运行了。</p>
<p>可以看到我在index里面只引用了add方法，但是在打包生成的文件里minus这个文件也存在打包文件里。虽然index.js里面只引用了math.js的一个方法，但是把所有的math.js都打包生成到了main.js里面。那这是没有必要的。因为业务代码只需要add。最理想的是我引用什么，就给我打包什么。在webpack 2.0以后提供了tree shaking的概念，意思是树抖动的意思。把没用的东西都摇晃掉。<br>tree shaking只支持 ES Module的引入方式，因为es module底层是一个静态引入的方式，而commonjs是动态引入的方式。</p>
<p>webpack.config.js</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">　　mode: <span class="string">'development'</span>,</span><br><span class="line">　　optimization: &#123;</span><br><span class="line">　　　　// 看一看哪些模块被导出了，再去打包</span><br><span class="line">　　　　useExports: <span class="literal">true</span></span><br><span class="line">　　&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>package.json</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">　　<span class="string">"sideEffects"</span>: <span class="literal">false</span></span><br><span class="line">　　/***</span><br><span class="line">　　* 把不需要tre shaking的模块配置在这里</span><br><span class="line">　　* 如果webpack引入了tree shaking，那么webpack只要打包一个模块，就会应用tree shaking这种</span><br><span class="line">　　* 方式打包。如果没有引入任何一个模块，<span class="string">"sideEffects"</span>: [<span class="string">"babel/polyfill"</span>]</span><br><span class="line">　　* babel/ polyfill引入就会报错。这里配置了后，tree shaking就不会去打包babel/polyfill</span><br><span class="line">　　* 但是现在我们写的是业务代码，不是第三方模块，不使用babel.polyfill，这是配置<span class="literal">false</span>，</span><br><span class="line">　　* 就是所有打包文件都走tree shaking。</span><br><span class="line">　　*/</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们再去打包，发现minus还在，但是tree shaking已经生效了，前面会提醒，他已经知道只用了add方法，</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/*! exports provided: add, minus */</span><br><span class="line">/*! exports used: add */</span><br></pre></td></tr></table></figure>

<p>但是在开发环境下，我们可能需要调试，报出来的行可能不准确，所以保留了代码。真正打包上线的时候，minus的代码就会不打包了这个时候。production的时候，optimization都不需要配置。production的时候tree shaking自动的配置好了。只需要 devtool: ‘cheap-module-eval-source-map’就可以</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/08/28/webpack系列/12webpack实现react代码打包/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="qicainiao">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="qicainiao's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/28/webpack系列/12webpack实现react代码打包/" itemprop="url">webpack系列-12webpack实现对react代码打包</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-08-28T14:48:04+08:00">
                2019-08-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>首先安装react相关能支持react代码的包</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install react react-dom --save</span><br></pre></td></tr></table></figure>

<p>index.js</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import <span class="string">"@babel/polyfill"</span>;</span><br><span class="line"></span><br><span class="line">import React, &#123; Component &#125; from <span class="string">'react'</span>;</span><br><span class="line">import ReactDom from <span class="string">'react-dom'</span>;</span><br><span class="line"></span><br><span class="line">class App extends Component &#123;</span><br><span class="line">　　<span class="function"><span class="title">render</span></span>() &#123;</span><br><span class="line">　　　　<span class="built_in">return</span> &lt;div&gt;Hello World&lt;/div&gt;</span><br><span class="line">　　&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ReactDom.render(&lt;App /&gt;, document.getElementById(<span class="string">'root'</span>));</span><br></pre></td></tr></table></figure>

<p>index.html</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"en"</span>&gt;</span><br><span class="line">　　&lt;head&gt;</span><br><span class="line">　　　　&lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">　　　　&lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span><br><span class="line">　　　　&lt;meta http-equiv=<span class="string">"X-UA-Compatible"</span> content=<span class="string">"ie=edge"</span>&gt;</span><br><span class="line">　　　　&lt;title&gt;html template&lt;/title&gt;</span><br><span class="line">　　&lt;/head&gt;</span><br><span class="line">　　&lt;body&gt;</span><br><span class="line">　　　　&lt;div id=<span class="string">'root'</span>&gt;&lt;/div&gt;</span><br><span class="line">　　&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>.babelrc</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">　　<span class="string">"presets"</span>: [</span><br><span class="line">　　　　[<span class="string">"@babel/preset-env"</span>,&#123;</span><br><span class="line">　　　　　　　　<span class="string">"targets"</span>: &#123;</span><br><span class="line">　　　　　　　　<span class="string">"chrome"</span>: <span class="string">"67"</span>,</span><br><span class="line">　　　　　　&#125;,</span><br><span class="line">　　　　　　<span class="string">"useBuiltIns"</span>: <span class="string">"usage"</span>,</span><br><span class="line">　　　　　　<span class="string">"corejs"</span>: 3</span><br><span class="line">　　　　&#125;],</span><br><span class="line">　　　　<span class="string">"@babel/preset-react"</span></span><br><span class="line">　　]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>再运行npm run start。就可以正确读取到hello world这个文本了</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/08/28/webpack系列/11webpack中使用babel处理es6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="qicainiao">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="qicainiao's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/28/webpack系列/11webpack中使用babel处理es6/" itemprop="url">webpack系列-11webpack中使用babel处理es6</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-08-28T14:37:10+08:00">
                2019-08-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>index.js</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">const arr = [</span><br><span class="line">　　new Promise(()=&gt;&#123;&#125;),</span><br><span class="line">　　new Promise(()=&gt;&#123;&#125;)</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">arr.map(item =&gt; &#123;</span><br><span class="line">　　console.log(item);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>index.html</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"en"</span>&gt;</span><br><span class="line">　　&lt;head&gt;</span><br><span class="line">　　　　&lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">　　　　&lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span><br><span class="line">　　　　&lt;meta http-equiv=<span class="string">"X-UA-Compatible"</span> content=<span class="string">"ie=edge"</span>&gt;</span><br><span class="line">　　　　&lt;title&gt;html template&lt;/title&gt;</span><br><span class="line">　　&lt;/head&gt;</span><br><span class="line">　　&lt;body&gt;</span><br><span class="line">　　　　&lt;div id=<span class="string">'root'</span>&gt;&lt;/div&gt;</span><br><span class="line">　　&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>运行npx webpack(用dev-server打包放在了缓存里面，看不到最终的打包内容)。看到打包生成的main.js的最后几行，index里面写的js，原封不动的打包到了main.js里面。这个时候浏览器中运行，可以打印出promise对象。好像是没问题的，这是什么原因呢，这是因为chrome更新比较快，es6里面很多东西，他都做了实现，所以直接在chrome浏览器写es6语法没问题，但是比如在ie或者更新没那么快的浏览器，，，就会报错。。。</p>
<p>这个时候需要接住babel,<a href="https://babeljs.io/。" target="_blank" rel="noopener">https://babeljs.io/。</a><br>先安装两个包</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev babel-loader @babel/core</span><br></pre></td></tr></table></figure>

<p>一个是帮助webpack打包用的工具，一个是babel的核心库<br>webpack配置babel相关</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">　　module: &#123;</span><br><span class="line">　　　　rules:[&#123;</span><br><span class="line">　　　　　　<span class="built_in">test</span>: /\.js$/,</span><br><span class="line">　　　　　　exclude: /node_modules/,</span><br><span class="line">　　　　　　loader: <span class="string">"babel-loader"</span></span><br><span class="line">　　　　&#125;]</span><br><span class="line">　　&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>再继续安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install @babel/preset-env --save-dev</span><br></pre></td></tr></table></figure>

<p>为什么要安装这个模块，当我们使用babel－loader处理js文件的时候，实际上这个babel-loader只是webpack和babel做通信的一个桥梁，用了他之后，webpack和babel做了打通，但实际上，babel-loader并不会帮助我们把es6语法翻译成es5语法，还需要借助一些其它的模块才能够帮助我们把es6语法翻译成es5语法。babel/preset-env就是这样的一个模块，这里面包含了所有把es6转化成es5的规则。装好之后，还需要在webpack里面配置一下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">　　module: &#123;</span><br><span class="line">　　　　rules:[&#123;</span><br><span class="line">　　　　　　<span class="built_in">test</span>: /\.js$/,</span><br><span class="line">　　　　　　exclude: /node_modules/,</span><br><span class="line">　　　　　　loader: <span class="string">"babel-loader"</span>,</span><br><span class="line">　　　　　　options:&#123;</span><br><span class="line">　　　　　　　　<span class="string">"presets"</span>: [<span class="string">"@babel/preset-env"</span>]</span><br><span class="line">　　　　　　&#125;</span><br><span class="line">　　　　&#125;]</span><br><span class="line">　　&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>再使用npx webpack，看转化后的main.js，发现es6的语法转化成了es5的语法。但是光做到这点不够。为什么呢？因为比如像Promise这样新的语法变量，包括数组里面这个map方法，在低版本的浏览器里，实际上还是不存在的。虽然了语法翻译，但只翻译了一部分。还有一些对象或者函数在一些低版本的浏览器里面还是没有的。</p>
<p>所以不仅要用preset-env翻译es6，还需要将缺失的语法补充到浏览器里，这个模块就是babel/polyfill。然后把polyfill引入到业务代码的最顶部<br>index.js</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import <span class="string">"@babel/polyfill"</span>;</span><br><span class="line"></span><br><span class="line">const arr = [</span><br><span class="line">　　new Promise(()=&gt;&#123;&#125;),</span><br><span class="line">　　new Promise(()=&gt;&#123;&#125;)</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">arr.map(item =&gt; &#123;</span><br><span class="line">　　console.log(item);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>处理好后，再运行，会发现原来打包好的main是28kb，现在是534kb。这多出来的内容就是polyfill弥补的内容，所以main.js一下子就变的很大。那么我不想要这么大，我只需要你在我需要补充语法的时候出来相应处理的代码就可以。<br>安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install core-js --save-dev</span><br></pre></td></tr></table></figure>

 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">　　module: &#123;</span><br><span class="line">　　　　rules:[&#123;</span><br><span class="line">　　　　　　<span class="built_in">test</span>: /\.js$/,</span><br><span class="line">　　　　　　exclude: /node_modules/,</span><br><span class="line">　　　　　　loader: <span class="string">"babel-loader"</span>,</span><br><span class="line">　　　　　　options:&#123;</span><br><span class="line">　　　　　　　　presets: [[<span class="string">'@babel/preset-env'</span>,&#123;</span><br><span class="line">　　　　　　　　/**</span><br><span class="line">　　　　　　　　* 当我做polyfill填充的时候，去加一些低版本特性的时候，我不是把所有特性都加进来</span><br><span class="line">　　　　　　　　* 是根据你的业务代码来决定要加什么</span><br><span class="line">　　　　　　　　*/</span><br><span class="line">　　　　　　　　useBuiltIns: <span class="string">'usage'</span>,</span><br><span class="line">　　　　　　　　corejs: 3</span><br><span class="line">　　　　　　　　&#125;]]</span><br><span class="line">　　　　　　&#125;</span><br><span class="line">　　　　&#125;]</span><br><span class="line">　　&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>主页打包出来的main就124kb，小了很多</p>
<p>当然preset也可以配置一些额外的参数<br> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">　　module: &#123;</span><br><span class="line">　　　　rules:[&#123;</span><br><span class="line">　　　　　　<span class="built_in">test</span>: /\.js$/,</span><br><span class="line">　　　　　　exclude: /node_modules/,</span><br><span class="line">　　　　　　loader: <span class="string">"babel-loader"</span>,</span><br><span class="line">　　　　　　options:&#123;</span><br><span class="line">　　　　　　　　presets: [[<span class="string">'@babel/preset-env'</span>,&#123;</span><br><span class="line">　　　　　　　　/**</span><br><span class="line">　　　　　　　　* 意思是我的这个项目，打包会运行在&gt;67这个版本的chrome浏览器下</span><br><span class="line">　　　　　　　　* 比如chrome浏览器在67版本以上对es6语法支持很好了，就不需要翻译</span><br><span class="line">　　　　　　　　*/</span><br><span class="line">　　　　　　　　targets: &#123;</span><br><span class="line">　　　　　　　　　　chrome: <span class="string">"67"</span>,</span><br><span class="line">　　　　　　　　&#125;,</span><br><span class="line">　　　　　　　　/**</span><br><span class="line">　　　　　　　　* 当我做polyfill填充的时候，去加一些低版本特性的时候，我不是把所有特性都加进来</span><br><span class="line">　　　　　　　　* 是根据你的业务代码来决定要加什么</span><br><span class="line">　　　　　　　　* @babel/polyfill，放在js入口</span><br><span class="line">　　　　　　　　*/</span><br><span class="line">　　　　　　　　useBuiltIns: <span class="string">'usage'</span>,</span><br><span class="line">　　　　　　　　corejs: 3</span><br><span class="line">　　　　　　　　&#125;]]</span><br><span class="line">　　　　　　&#125;</span><br><span class="line">　　　　&#125;]</span><br><span class="line">　　&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>再运行npm run bundle，发现main.js重新变成了28.8kb。</p>
<p>这种方案不一定所有场景都适用，在开发一个第三方模块的时候，这个时候用polyfill注入是有问题的，因为这是时候注入会以全局变量的方式注入，会污染到全局环境。所以我们在打包UI组件库或者类库的时候，需要换一种打包的方式。去除index的pollfile。webpack也不做presets的配置了<br>首先安装</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev @babel/plugin-transform-runtime</span><br><span class="line">npm install --save @babel/runtime</span><br></pre></td></tr></table></figure>

<p>index.js</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// import <span class="string">"@babel/polyfill"</span>;</span><br><span class="line"></span><br><span class="line">const arr = [</span><br><span class="line">　　new Promise(()=&gt;&#123;&#125;),</span><br><span class="line">　　new Promise(()=&gt;&#123;&#125;)</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">arr.map(item =&gt; &#123;</span><br><span class="line">　　console.log(item);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">　　module: &#123;</span><br><span class="line">　　　　rules:[&#123;</span><br><span class="line">　　　　　　<span class="built_in">test</span>: /\.js$/,</span><br><span class="line">　　　　　　exclude: /node_modules/,</span><br><span class="line">　　　　　　loader: <span class="string">"babel-loader"</span>,</span><br><span class="line">　　　　　　options:&#123;</span><br><span class="line">　　　　　　　　<span class="string">"plugins"</span>: [[<span class="string">"@babel/plugin-transform-runtime"</span>,&#123;</span><br><span class="line">　　　　　　　　<span class="string">"absoluteRuntime"</span>: <span class="literal">false</span>,</span><br><span class="line">　　　　　　　　<span class="string">"corejs"</span>: 2,</span><br><span class="line">　　　　　　　　<span class="string">"helpers"</span>: <span class="literal">true</span>,</span><br><span class="line">　　　　　　　　<span class="string">"regenerator"</span>: <span class="literal">true</span>,</span><br><span class="line">　　　　　　　　<span class="string">"useESModules"</span>: <span class="literal">false</span></span><br><span class="line">　　　　　　　　&#125;]]</span><br><span class="line">　　　　　　&#125;</span><br><span class="line">　　　　&#125;]</span><br><span class="line">　　&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>再强调一遍，如果我们写的只是业务代码，在配置的时候只要配置presets,同时引入pollfill就可以了。如果你写的是一个库项目代码的时候，这个时候要使用babel/plugin-transform-runtime。这个时候可以有效的避免presets,或者说是pollfill的问题。pollfile会污染全局环境。但是plugin-transform-runtime会以闭包的方式注入。这样写类库的时候是更好的方式。</p>
<p>另外补充一个知识点，如果我们认真的去配置babel相关的配置，会发现非常的长。我们可以在根目录新建一个文件。叫.babelrc。然后把options对象拿出来放到.babelrc里面。然后删除babel配置的option<br>.babelrc</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">　　<span class="string">"plugins"</span>: [[<span class="string">"@babel/plugin-transform-runtime"</span>,&#123;</span><br><span class="line">　　<span class="string">"absoluteRuntime"</span>: <span class="literal">false</span>,</span><br><span class="line">　　<span class="string">"corejs"</span>: 2,</span><br><span class="line">　　<span class="string">"helpers"</span>: <span class="literal">true</span>,</span><br><span class="line">　　<span class="string">"regenerator"</span>: <span class="literal">true</span>,</span><br><span class="line">　　<span class="string">"useESModules"</span>: <span class="literal">false</span></span><br><span class="line">　　&#125;]]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>webpack.config.js</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">　　module: &#123;</span><br><span class="line">　　　　rules:[&#123;</span><br><span class="line">　　　　　　test: /\.js$/,</span><br><span class="line">　　　　　　exclude: /node_modules/,</span><br><span class="line">　　　　　　loader: &quot;babel-loader&quot;</span><br><span class="line">　　　　&#125;]</span><br><span class="line">　　&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这样执行起来 npm run bundle 不会有任何问题</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/08/28/webpack系列/10webpack热模块更新/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="qicainiao">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="qicainiao's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/28/webpack系列/10webpack热模块更新/" itemprop="url">webpack系列-10webpack热模块更新</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-08-28T14:25:24+08:00">
                2019-08-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Hot Module Replacement，热模块更新，很多时候会简写成HMR。</p>
<p>首先我们把package.json里面的script改成</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"scripts"</span>: &#123;</span><br><span class="line">　　<span class="string">"start"</span>: <span class="string">"webpack-dev-server"</span>,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>在加热更新之前，我们运行npm run start，会发现之前我们打包有个dist目录，为什么运行这个命令的时候，dist目录没有了。实际上，webpack-dev-server，还是会对src目录下进行打包的。但是打包生成的文件，他并不会放在dist目录下。而是放到电脑中的内存里面。这样的话，可以有效的提升打包的速度。让我们开发更快，所以不用担心。</p>
<p>index.js</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var btn = document.createElement(<span class="string">'button'</span>);</span><br><span class="line">btn.innerHTML = <span class="string">'新增'</span>;</span><br><span class="line">document.body.appendChild(btn);</span><br><span class="line"></span><br><span class="line">btn.onclick = <span class="function"><span class="title">function</span></span>() &#123;</span><br><span class="line">　　var div = document.createElement(<span class="string">'div'</span>);</span><br><span class="line">　　div.innerHTML = <span class="string">'item'</span>;</span><br><span class="line">　　document.body.appendChild(div);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个js是点击一下新增，就新增一个item的div。现在我要实现一个样式的效果。偶数的时候给他加个背景</p>
<p>style.css</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">div:nth-of-type(odd) &#123;</span><br><span class="line">　　background: yellow;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个时候我把yellow改成blue。webpack-dev-server检测到代码对变化就会重新刷新，需要重新点击去测试。那之前好不容易点的东西没有了，又要重新点击，于是我就希望，当改变样式代码的时候，不要刷新页面，只要改变样式就行了，不要给我删除掉之前的dom。这个时候就用到了HMR</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">　　// 起个服务器</span><br><span class="line">　　devServer: &#123;</span><br><span class="line">　　　　// 这个意思是服务器要生成在哪个文件夹下</span><br><span class="line">　　　　contentBase:<span class="string">'./dist'</span>,</span><br><span class="line">　　　　// 启动的时候自动打开浏览器，然后自动访问这个服务器地址</span><br><span class="line">　　　　open:<span class="literal">true</span>,</span><br><span class="line">　　　　// 开启Hot Module Replacement</span><br><span class="line">　　　　hot: <span class="literal">true</span>,</span><br><span class="line">　　　　// 即便hmr的功能没有生效，浏览器也不要自动刷新</span><br><span class="line">　　　　hotOnly: <span class="literal">true</span></span><br><span class="line">　　&#125;,</span><br><span class="line">　　// HtmlWebpackPlugin会在打包结束后，自动生成一个html文件，并把打包生成的js自动引入到这个html文件中</span><br><span class="line">　　plugins: [</span><br><span class="line">　　　　new HtmlWebpackPlugin(&#123;</span><br><span class="line">　　　　　　template: <span class="string">'src/index.html'</span></span><br><span class="line">　　　　&#125;),</span><br><span class="line">　　　　new CleanWebpackPlugin(),</span><br><span class="line">　　　　// 当dev-server,两项host配置搞定后，再使用这个插件后，hmr功能就生效了</span><br><span class="line">　　　　new webpack.HotModuleReplacementPlugin()</span><br><span class="line">　　],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个时候再去更改样式，就不会影响之前js对html的变更。改了css文件，就只会替换css的内容<br>所以使用HMR的好处是,在写css的时候，方便调试css。</p>
<p>这是时候再把上面的配置恢复到没有hmr的时候</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">　　// 起个服务器</span><br><span class="line">　　devServer: &#123;</span><br><span class="line">　　　　// 这个意思是服务器要生成在哪个文件夹下</span><br><span class="line">　　　　contentBase:<span class="string">'./dist'</span>,</span><br><span class="line">　　　　// 启动的时候自动打开浏览器，然后自动访问这个服务器地址</span><br><span class="line">　　　　open:<span class="literal">true</span></span><br><span class="line">　　&#125;,</span><br><span class="line">　　// HtmlWebpackPlugin会在打包结束后，自动生成一个html文件，并把打包生成的js自动引入到这个html文件中</span><br><span class="line">　　plugins: [</span><br><span class="line">　　　　new HtmlWebpackPlugin(&#123;</span><br><span class="line">　　　　　　template: <span class="string">'src/index.html'</span></span><br><span class="line">　　　　&#125;),</span><br><span class="line">　　　　new CleanWebpackPlugin()</span><br><span class="line">　　],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>index.js</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import counter from <span class="string">'./counter'</span>;</span><br><span class="line">import number from <span class="string">'./number'</span>;</span><br><span class="line"></span><br><span class="line">counter();</span><br><span class="line">number();</span><br></pre></td></tr></table></figure>

<p>counter.js</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">counter</span></span>() &#123;</span><br><span class="line">　　var div = document.createElement(<span class="string">'div'</span>);</span><br><span class="line">　　div.setAttribute(<span class="string">'id'</span>, <span class="string">'counter'</span>);</span><br><span class="line">　　div.innerHTML = 1;</span><br><span class="line">　　div.onclick = <span class="function"><span class="title">function</span></span>() &#123;</span><br><span class="line">　　div.innerHTML = parseInt(div.innerHTML, 10) + 1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">document.body.appendChild(div);</span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> default counter;</span><br></pre></td></tr></table></figure>

<p>number.js</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">number</span></span>() &#123;</span><br><span class="line">　　var div = document.createElement(<span class="string">'div'</span>);</span><br><span class="line">　　div.setAttribute(<span class="string">'id'</span>, <span class="string">'number'</span>);</span><br><span class="line">　　div.innerHTML = 1000;</span><br><span class="line">　　document.body.appendChild(div);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">export</span> default number;</span><br></pre></td></tr></table></figure>

<p> 这个时候运行页面，把1增加到10。这个时候将number.js里面写死的1000变成2000。发现，呀，我之前点击到的10，又重新恢复到了1。说明刷新了页面。之前的一些数据没有保存下来。我希望number的数据更新到，别去更新我counter.js到内容。这时候把配置加回来</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">　　// 起个服务器</span><br><span class="line">　　devServer: &#123;</span><br><span class="line">　　　　// 这个意思是服务器要生成在哪个文件夹下</span><br><span class="line">　　　　contentBase:<span class="string">'./dist'</span>,</span><br><span class="line">　　　　// 启动的时候自动打开浏览器，然后自动访问这个服务器地址</span><br><span class="line">　　　　open:<span class="literal">true</span>,</span><br><span class="line">　　　　// 开启Hot Module Replacement</span><br><span class="line">　　　　hot: <span class="literal">true</span>,</span><br><span class="line">　　　　// 即便hmr的功能没有生效，浏览器也不要自动刷新</span><br><span class="line">　　　　hotOnly: <span class="literal">true</span></span><br><span class="line">　　&#125;,</span><br><span class="line">　　// HtmlWebpackPlugin会在打包结束后，自动生成一个html文件，并把打包生成的js自动引入到这个html文件中</span><br><span class="line">　　plugins: [</span><br><span class="line">　　　　new HtmlWebpackPlugin(&#123;</span><br><span class="line">　　　　　　template: <span class="string">'src/index.html'</span></span><br><span class="line">　　　　&#125;),</span><br><span class="line">　　　　new CleanWebpackPlugin(),</span><br><span class="line">　　　　// 当dev-server,两项host配置搞定后，再使用这个插件后，hmr功能就生效了</span><br><span class="line">　　　　new webpack.HotModuleReplacementPlugin()</span><br><span class="line">　　],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>发现number代码改成2000，页面上的1000并没有变成2000。这个时候需要自己去加点代码</p>
<p>index.js</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">import counter from <span class="string">'./counter'</span>;</span><br><span class="line">import number from <span class="string">'./number'</span>;</span><br><span class="line"></span><br><span class="line">counter();</span><br><span class="line">number();</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(module.hot) &#123;</span><br><span class="line">　　module.hot.accept(<span class="string">'./number'</span>, ()=&gt;&#123;</span><br><span class="line">　　　　<span class="built_in">let</span> removeNode = document.getElementById(<span class="string">'number'</span>);</span><br><span class="line">　　　　document.body.removeChild(removeNode);</span><br><span class="line">　　　　number();</span><br><span class="line">　　&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个时候把1点到10。再去更改number里面的代码，把1000改成2000。这个时候发现10没有任何变化，只从1000更新到20000。</p>
<p>那么这个时候就会想css会自动更新，这里却要在index里面多加这层判断。其实css也是要加这层判断的，只是css-loader里面已经加了这段代码，所以不用写。react,vue里面也内置了这些代码。本质上要写hmr的内容，都需要写这段。只不过框架帮我们实现了，自己不用去写。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/08/28/webpack系列/9webpackDevServer提升开发效率/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="qicainiao">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="qicainiao's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/28/webpack系列/9webpackDevServer提升开发效率/" itemprop="url">webpack系列-9webpackDevServer提升开发效率</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-08-28T14:21:01+08:00">
                2019-08-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>我们目前的状态是，如果代码有变动，每次都需要执行npm run bundle，然后打开index.html，在浏览器里面运行才行。这样，实际上，开发效率是比较低的。我希望如果代码改动，dist会自动的更改，再去看页面效果，刷新就好了。</p>
<p>首先我们把package.json里面的script改成</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"scripts"</span>: &#123;</span><br><span class="line">　　<span class="string">"watch"</span>: <span class="string">"webpack --watch"</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>这里加个watch是什么意思呢？意思是webpack会帮我们去watch，监听他打包的文件，只要打包的文件发生变化，他就会自动的重新打包。</p>
<p>但是这个方式还是不够好，我希望，不仅自动打包，而且第一次watch的时候，自动给我打开浏览器，这个时候可以配合webpack的devServer来实现。需要安装webpack-dev-server<br>webpack下配置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">　　// 起个服务器</span><br><span class="line">　　devServer: &#123;</span><br><span class="line">　　// 这个意思是服务器要生成在哪个文件夹下</span><br><span class="line">　　　　contentBase:<span class="string">'./dist'</span></span><br><span class="line">　　&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>package.json</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"scripts"</span>: &#123;</span><br><span class="line">　　<span class="string">"watch"</span>: <span class="string">"webpack --watch"</span>,</span><br><span class="line">　　<span class="string">"start"</span>: <span class="string">"webpack-dev-server"</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>然后启动npm run start。他会提示我们Project is running at <a href="http://localhost:8080/。然后浏览器打开这个网页，在js发生变化的时候，webpack-dev-server也能感知到js发生的变化，会自动更新，不用重新刷新。" target="_blank" rel="noopener">http://localhost:8080/。然后浏览器打开这个网页，在js发生变化的时候，webpack-dev-server也能感知到js发生的变化，会自动更新，不用重新刷新。</a></p>
<p>所以webpack-dev-server比刚才的watch好在哪里。他不但会监听变化，重新帮我们打包，还会自动的重新刷新浏览器。这个时候我们再对webpack做一个配置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">　　// 起个服务器</span><br><span class="line">　　devServer: &#123;</span><br><span class="line">　　　　// 这个意思是服务器要生成在哪个文件夹下</span><br><span class="line">　　　　contentBase:<span class="string">'./dist'</span>,</span><br><span class="line">　　　　// 启动的时候自动打开浏览器，然后自动访问这个服务器地址</span><br><span class="line">　　　　open:<span class="literal">true</span></span><br><span class="line">　　&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>那么为什么要开这样一个服务器呢，我们在写react,vue的时候，知道前端都要写个ajax去请求，如果是通过npm run bundle,通过原始的webpack打包，打开dist文件下的index.html。这个时候页面去发ajax请求就不行了。因为如果要发ajax请求，这个地址必须在服务器上，通过http的形式打开。所以需要webpack-dev-server。</p>
<p>我们不管写react还是vue。里面都有一个proxy这样的配置。实际上是帮助我们跨域的时候使用的接口代理。那为什么在react,vue之中可以使用接口代理呢？是因为，他们的底层都使用了webpack-dev-server。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// 起个服务器</span><br><span class="line">devServer: &#123;</span><br><span class="line">　　// 这个意思是服务器要生成在哪个文件夹下</span><br><span class="line">　　contentBase:<span class="string">'./dist'</span>,</span><br><span class="line">　　// 启动的时候自动打开浏览器，然后自动访问这个服务器地址</span><br><span class="line">　　open:<span class="literal">true</span>,</span><br><span class="line">　　// 如果浏览器访问localhost:8080/api下的地址，会自动转发到http://localhost:3000下</span><br><span class="line">　　proxy: &#123;</span><br><span class="line">　　　　<span class="string">'/api'</span>: <span class="string">'http://localhost:3000'</span></span><br><span class="line">　　&#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>除了这三个配置，还可以有很多其它到配置项，<a href="https://webpack.js.org/configuration/dev-server#devserverproxy" target="_blank" rel="noopener">https://webpack.js.org/configuration/dev-server#devserverproxy</a></p>
<p>在我们使用比较老到脚手架工具，会发现他并没有配置webpack-dev-server。而是自己实现了一个类似于webpack-dev-server这样到内容。为什么呢，因为比较早的时候，webpack-dev-server不是特别的稳定。配置项也不多，有些作者认为不好用，就自己实现了</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"scripts"</span>: &#123;</span><br><span class="line">　　<span class="string">"bundle"</span>: <span class="string">"webpack"</span>,</span><br><span class="line">　　<span class="string">"watch"</span>: <span class="string">"webpack --watch"</span>,</span><br><span class="line">　　<span class="string">"start"</span>: <span class="string">"webpack-dev-server"</span>,</span><br><span class="line">　　<span class="string">"server"</span>: <span class="string">"node server.js"</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>安装 npm install express webpack-dev-middleware -D。</p>
<p>在根目录下创建server.js</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">const express = require(<span class="string">'express'</span>);</span><br><span class="line">const webpack = require(<span class="string">'webpack'</span>);</span><br><span class="line">const webpackDevMiddleware = require(<span class="string">'webpack-dev-middleware'</span>);</span><br><span class="line">const config = require(<span class="string">'./webpack.config.js'</span>);</span><br><span class="line">const complier = webpack(config);</span><br><span class="line"></span><br><span class="line">const app = express();</span><br><span class="line">app.use(webpackDevMiddleware(complier,&#123;</span><br><span class="line">　　publicPath:config.output.publicPath</span><br><span class="line">&#125;))</span><br><span class="line"></span><br><span class="line">app.listen(3000, ()=&gt;&#123;</span><br><span class="line">　　console.log(<span class="string">'server is running'</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>然后运行localhost:3000就运行。实际上这样自己写，得到跟webpack-dev-server一样的效果，自己需要写很多内容。所以webpack-dev-server是最推荐的方式，也是业界用的最多的。<br>所以这种方式是在node中使用webpack</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/08/28/webpack系列/8webpack中SourceMap的配置/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="qicainiao">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="qicainiao's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/28/webpack系列/8webpack中SourceMap的配置/" itemprop="url">webpack系列-8webpack中SourceMap的配置</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-08-28T14:14:36+08:00">
                2019-08-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>希望在开发的时候，不要告诉我压缩文件哪一行代码出错了，而是告诉我具体的哪个文件，哪行js代码出错了。</p>
<p>什么是SourceMap?<br>现在知道dist目录下main.js文件96行出错<br>sourceMap 它是一个映射关系，他知道dist目录下main.js文件96行，实际上对应的是src目录下index.js的第一行。<br>当前其实是index.js的第一行</p>
<p>配置，其实webpack默认是把sourceMap配置进去了，去掉SourceMap</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">　　mode: <span class="string">'development'</span>,</span><br><span class="line">　　// 默认sourceMap配置进去了，所以先把sourceMap把他关掉</span><br><span class="line">　　devtool: <span class="string">'none'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>加上SourceMap配置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">　　mode: <span class="string">'development'</span>,</span><br><span class="line">　　devtool: <span class="string">'inline-source-map'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>用inline的时候js.map文件会变成base64的字符串被压缩到main.js里面。会告诉我们哪一行哪一列出错了</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">　　mode: <span class="string">'development'</span>,</span><br><span class="line">　　devtool: <span class="string">'cheap-inline-source-map'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>用cheap-inline会告诉我们哪一行出错了，不会告诉我们哪一列</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">　　mode: <span class="string">'development'</span>,</span><br><span class="line">　　devtool: <span class="string">'inline-cheap-module-source-map'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>inline-cheap-module-source-map表示我不仅管业务代码的错误，还管第三方模块代码的错误</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">　　mode: <span class="string">'development'</span>,</span><br><span class="line">　　devtool: <span class="string">'eval'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>eval是打包最快的一种，但是针对于比较复杂的情况下，eval提示的信息不一定全面</p>
<p>最佳实践</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">　　mode: <span class="string">'development'</span>,</span><br><span class="line">　　devtool: <span class="string">'cheap-module-eval-source-map'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这种方式提示的错误比较全，打包速度比较快，</p>
<p>如果是线上，建议这样</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">　　mode: <span class="string">'production'</span>,</span><br><span class="line">　　devtool: <span class="string">'cheap-module-source-map'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/08/28/webpack系列/7webpack中Entry与Output基础配置/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="qicainiao">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="qicainiao's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/28/webpack系列/7webpack中Entry与Output基础配置/" itemprop="url">webpack系列-7webpack中Entry与Output的基础配置</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-08-28T14:06:43+08:00">
                2019-08-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>entry顾名思义，就是打包的入口文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">　　// 这个文件要做打包，从哪一个文件开始打包</span><br><span class="line">　　entry: <span class="string">'./src/index.js'</span>,  //等同于 entry: &#123; main: <span class="string">'./src/index.js'</span> &#125;</span><br><span class="line"></span><br><span class="line">　　// 打包文件要放到哪里去，就配置在output这个对象里</span><br><span class="line">　　output: &#123;</span><br><span class="line">　　　　// 打包好的文件名字</span><br><span class="line">　　　　filename: <span class="string">'bundle.js'</span>,</span><br><span class="line">　　　　/**</span><br><span class="line">　　　　* 打包出的文件要把他放到哪一个文件夹下，path后面要放一个绝对路径</span><br><span class="line">　　　　* __dirname指的是webpack.config.js所在的当前目录的这个路径</span><br><span class="line">　　　　* 下面这个结合就是一个绝对路径</span><br><span class="line">　　　　*/</span><br><span class="line">　　　　path: path.resolve(__dirname, <span class="string">'dist'</span>)</span><br><span class="line">　　&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>打包生成的文件，默认的名字叫main。打包生成的文件叫做bundle.js，如果我把这个自定义的打包好的名字去掉。那么打包生成的名字是什么，是main.js。所以这个名字，就是打包生成的名字。</p>
<p>现在我有一个需求，我希望，这个index.js，反复生成两次，第一个文件叫做main，第二个文件叫做sub。打包生成的名字还是叫bundle</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">　　// 这个文件要做打包，从哪一个文件开始打包</span><br><span class="line">　　entry: &#123;</span><br><span class="line">　　　　main: <span class="string">'./src/index.js'</span>,</span><br><span class="line">　　　　sub:<span class="string">'./src/index.js'</span></span><br><span class="line">　　&#125;,</span><br><span class="line"></span><br><span class="line">　　// 打包文件要放到哪里去，就配置在output这个对象里</span><br><span class="line">　　output: &#123;</span><br><span class="line">　　　　// 打包好的文件名字</span><br><span class="line">　　　　filename: <span class="string">'bundle.js'</span>,</span><br><span class="line">　　　　/**</span><br><span class="line">　　　　* 打包出的文件要把他放到哪一个文件夹下，path后面要放一个绝对路径</span><br><span class="line">　　　　* __dirname指的是webpack.config.js所在的当前目录的这个路径</span><br><span class="line">　　　　* 下面这个结合就是一个绝对路径</span><br><span class="line">　　　　*/</span><br><span class="line">　　　　path: path.resolve(__dirname, <span class="string">'dist'</span>)</span><br><span class="line">　　&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个时候会报错，如图。</p>
<p><img src="/images/7-1.png" alt></p>
<p>为什么呢？现在要用index.js生成两个文件，一个叫做main,一个叫sub，但是这两个文件最终都会被取名叫做bundle.js。这样取名就重复了。就冲突了，想要解决这个问题，我们把filename替换成一个占位符</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">output: &#123;</span><br><span class="line">　　// 打包好的文件名字</span><br><span class="line">　　filename: <span class="string">'[name].js'</span>,</span><br><span class="line">　　path: path.resolve(__dirname, <span class="string">'dist'</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是一般我们做好的项目都会上传到线上，域名下到文件，这个时候自动生成的index.html里面的js路径不是我想要到，我想要在路径前面加上域名</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;script <span class="built_in">type</span>=<span class="string">"text/javascript"</span> src=<span class="string">"main.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;script <span class="built_in">type</span>=<span class="string">"text/javascript"</span> src=<span class="string">"sub.js"</span>&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>这个自动插入的js想变成这样</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;script <span class="built_in">type</span>=<span class="string">"text/javascript"</span> src=<span class="string">"http://cdn.com/main.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;script <span class="built_in">type</span>=<span class="string">"text/javascript"</span> src=<span class="string">"http://cdn.com/sub.js"</span>&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>我们可以在webpack里面配置一个内容</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">output: &#123;</span><br><span class="line">　　publicPath: <span class="string">'http://cdn.com.cn'</span>,</span><br><span class="line">　　filename: <span class="string">'[name].js'</span>,</span><br><span class="line">　　path: path.resolve(__dirname, <span class="string">'dist'</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>再去运行 npm run bundle。生成index.html</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"en"</span>&gt;</span><br><span class="line">　　&lt;head&gt;</span><br><span class="line">　　　　&lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">　　　　&lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span><br><span class="line">　　　　&lt;meta http-equiv=<span class="string">"X-UA-Compatible"</span> content=<span class="string">"ie=edge"</span>&gt;</span><br><span class="line">　　　　&lt;title&gt;html template&lt;/title&gt;</span><br><span class="line">　　&lt;/head&gt;</span><br><span class="line">　　&lt;body&gt;</span><br><span class="line">　　　　&lt;div id=<span class="string">'root'</span>&gt;&lt;/div&gt;</span><br><span class="line">　　　　&lt;script <span class="built_in">type</span>=<span class="string">"text/javascript"</span> src=<span class="string">"http://cdn.com.cn/main.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">　　　　&lt;script <span class="built_in">type</span>=<span class="string">"text/javascript"</span> src=<span class="string">"http://cdn.com.cn/sub.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">　　&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>会发现自动带了域名</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/08/28/webpack系列/6使用plugins让打包更便捷/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="qicainiao">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="qicainiao's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/28/webpack系列/6使用plugins让打包更便捷/" itemprop="url">webpack系列-6使用plugins让打包更便捷</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-08-28T13:59:13+08:00">
                2019-08-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>之前运行dist下的js，都是手动把index.html拷贝过去的，每次把dist文件夹删除，都需要将index.html拷贝进去，这样很麻烦，我们在webpack官方插件中找到HtmlWebpackPlugin</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">　　/**</span><br><span class="line">　　* 打包模式，不配置会警告，但底层还是会去配置默认的，就是production</span><br><span class="line">　　* production: 压缩模式，被压缩的代码</span><br><span class="line">　　* development: 开发模式，不压缩的代码</span><br><span class="line">　　*</span><br><span class="line">　　*/</span><br><span class="line">　　mode: <span class="string">'development'</span>,</span><br><span class="line">　　// 这个文件要做打包，从哪一个文件开始打包</span><br><span class="line">　　entry: <span class="string">'./src/index.js'</span>,</span><br><span class="line"></span><br><span class="line">　　plugins: [new HtmlWebpackPlugin()],</span><br><span class="line">　　// 打包文件要放到哪里去，就配置在output这个对象里</span><br><span class="line">　　output: &#123;</span><br><span class="line">　　　　// 打包好的文件名字</span><br><span class="line">　　　　filename: <span class="string">'bundle.js'</span>,</span><br><span class="line">　　　　/**</span><br><span class="line">　　　　* 打包出的文件要把他放到哪一个文件夹下，path后面要放一个绝对路径</span><br><span class="line">　　　　* __dirname指的是webpack.config.js所在的当前目录的这个路径</span><br><span class="line">　　　　* 下面这个结合就是一个绝对路径</span><br><span class="line">　　　　*/</span><br><span class="line">　　　　path: path.resolve(__dirname, <span class="string">'dist'</span>)</span><br><span class="line">　　&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这样配置好，再去打包，发现会自动生成一个index.html，<br>index.html</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">　　&lt;head&gt;</span><br><span class="line">　　　　&lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">　　　　&lt;title&gt;Webpack App&lt;/title&gt;</span><br><span class="line">　　&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">　　&lt;script <span class="built_in">type</span>=<span class="string">"text/javascript"</span> src=<span class="string">"bundle.js"</span>&gt;&lt;/script&gt;&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>html里面还引入了bundle.js。而且在src里面我并没有这个index.html.这就是webpack里面插件的作用</p>
<p>HtmlWebpackPlugin这个插件能干什么呢？HtmlWebpackPlugin会在打包结束后，自动生成一个html文件，并把打包生成的js自动引入到这个html文件中<br>我们再打开index.html，发现网页上什么也没有。为什么呢？</p>
<p>我们看自己的代码逻辑<br>index.js</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var root = document.getElementById(<span class="string">'root'</span>);</span><br><span class="line">import <span class="string">'./index.scss'</span>;</span><br><span class="line"></span><br><span class="line">root.innerHTML = <span class="string">'&lt;div class="iconfont iconfangdajing"&gt;abc&lt;/div&gt;'</span>;</span><br></pre></td></tr></table></figure>

<p>代码逻辑是找到id为root到节点，再把abc挂在到root上。但是我们看index.html并没有root这个标签。所以说明用webpack生成到这个html，少了一个id为root的标签。那我想让他自动生成这个id为root的标签，怎么办，可以对这个html-webpack-plugin做一个配置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">plugins: [new HtmlWebpackPlugin(&#123;</span><br><span class="line">　　template: <span class="string">'src/index.html'</span></span><br><span class="line">&#125;)],</span><br></pre></td></tr></table></figure>

<p>然后在src里面自己写一个模版index.html</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"en"</span>&gt;</span><br><span class="line">　　&lt;head&gt;</span><br><span class="line">　　　　&lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">　　　　&lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span><br><span class="line">　　　　&lt;meta http-equiv=<span class="string">"X-UA-Compatible"</span> content=<span class="string">"ie=edge"</span>&gt;</span><br><span class="line">　　　　&lt;title&gt;html template&lt;/title&gt;</span><br><span class="line">　　&lt;/head&gt;</span><br><span class="line">　　&lt;body&gt;</span><br><span class="line">　　　　&lt;div id=<span class="string">'root'</span>&gt;&lt;/div&gt;</span><br><span class="line">　　&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>然后运行npm run bundle，打开自动生成的html</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"en"</span>&gt;</span><br><span class="line">　　&lt;head&gt;</span><br><span class="line">　　　　&lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">　　　　&lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span><br><span class="line">　　　　&lt;meta http-equiv=<span class="string">"X-UA-Compatible"</span> content=<span class="string">"ie=edge"</span>&gt;</span><br><span class="line">　　　　&lt;title&gt;html template&lt;/title&gt;</span><br><span class="line">　　&lt;/head&gt;</span><br><span class="line">　　&lt;body&gt;</span><br><span class="line">　　　　&lt;div id=<span class="string">'root'</span>&gt;&lt;/div&gt;</span><br><span class="line">　　　　&lt;script <span class="built_in">type</span>=<span class="string">"text/javascript"</span> src=<span class="string">"bundle.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">　　&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>可以惊讶的看到id为root的标签插入进去了。这是为什么呢？</p>
<p>html-webpack-plugin会自动生成一个html，这个html是以哪个模版生成的呢，是src下面的index.html为模板生成的。生成之后，会把打包出来bundle.js注入到html中。</p>
<p>通过这个例子，我们说明一下webpack中plugin的作用。<br>plugin可以在webpack运行到某个时刻的时候，帮你做一些事情。这个很像生命周期函数的定义。这个时刻是什么时刻呢，就是webpack打包结束的时刻。其它的插件也会在某些时刻做一些事情，比如刚打包的时刻。比如打包js的某个时刻。再举个例子。。</p>
<p>我们现在打包好的名字叫bundle.js，现在我改一下，叫做dist.js</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">output: &#123;</span><br><span class="line">　　filename: <span class="string">'dist.js'</span>,</span><br><span class="line">　　path: path.resolve(__dirname, <span class="string">'dist'</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后重新打包，然后dist目录下会多出一个dist.js文件，html里面自动引入的也是dist.js文件。但是我们看bundle.js的文件依然存在，为什么呀，一个是我们刚才没有删除dist，再打包，但每次打包都需要删除一下，会很麻烦。我们希望每次打包的时候，自动将dist删除，这样就不会有上次遗留的东西了。现在就需要另外一个插件，在官网webpack下找不到，叫做clean-webpack-plugin<br>先安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install clean-webpack-plugin -D</span><br></pre></td></tr></table></figure>

<p>装好之后，我们去增加配置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">plugins: [</span><br><span class="line">　　new HtmlWebpackPlugin(&#123;</span><br><span class="line">　　　　template: <span class="string">'src/index.html'</span></span><br><span class="line">　　&#125;), new CleanWebpckPlugin()</span><br><span class="line">],</span><br></pre></td></tr></table></figure>

<p>这个意思是在打包之前先删除掉dist这个文件夹。这样运行npm run bundle，之前bundle.js就不在了。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/08/28/webpack系列/5使用loader打包静态文件/5使用loader打包静态文件-样式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="qicainiao">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="qicainiao's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/28/webpack系列/5使用loader打包静态文件/5使用loader打包静态文件-样式/" itemprop="url">webpack系列-5使用loader打包静态文件－样式</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-08-28T13:42:08+08:00">
                2019-08-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>我们写了一个样式文件</p>
<p>index.css</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.avatar &#123;</span><br><span class="line">　　width: 150px;</span><br><span class="line">　　height: 150px;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>index.js</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import avatar from <span class="string">'./avatar.jpg'</span>;</span><br><span class="line">import <span class="string">'./index.css'</span>;</span><br><span class="line"></span><br><span class="line">var img = new Image();</span><br><span class="line">img.src = avatar;</span><br><span class="line">img.classList.add(<span class="string">'avatar'</span>);</span><br><span class="line"></span><br><span class="line">var root = document.getElementById(<span class="string">'root'</span>);</span><br><span class="line">root.appendChild(img);</span><br></pre></td></tr></table></figure>

<p>这个时候我们运行npm run bundle，发现报错了</p>
<p>webpack默认只知道打包js文件，引入css的时候，他不知道你要干什么，所以这个时候需要让webpack知道</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// 打包模块不知道该怎么办，就去模块配置里面该怎么办</span><br><span class="line">module: &#123;</span><br><span class="line">　　// 规则</span><br><span class="line">　　rules: [&#123;</span><br><span class="line">　　　　// 假设是以css结尾的，我需要一个load帮助我们去打包</span><br><span class="line">　　　　<span class="built_in">test</span>: /\.css$/,</span><br><span class="line">　　　　// 需要两个loader，所以不能是个对象，需要是个数组</span><br><span class="line">　　　　use: [<span class="string">'style-loader'</span>,<span class="string">'css-loader'</span>]</span><br><span class="line">　　&#125;]</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>这个时候打包就没有问题了。</p>
<p>整理：开始遇到css，webpack不知道怎么打包，加了配置之后，webpack知道了怎么打包。那么对应的style-loader,css-loader的作用是什么呢</p>
<p>假设我把文件改一下<br>avatar.css</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.avatar &#123;</span><br><span class="line">　　width: 150px;</span><br><span class="line">　　height: 150px;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>index.css</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@import <span class="string">'./avatar.css'</span>;</span><br></pre></td></tr></table></figure>

<p>index.js</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import avatar from <span class="string">'./avatar.jpg'</span>;</span><br><span class="line">import <span class="string">'./index.css'</span>;</span><br><span class="line"></span><br><span class="line">var img = new Image();</span><br><span class="line">img.src = avatar;</span><br><span class="line">img.classList.add(<span class="string">'avatar'</span>);</span><br><span class="line"></span><br><span class="line">var root = document.getElementById(<span class="string">'root'</span>);</span><br><span class="line">root.appendChild(img);</span><br></pre></td></tr></table></figure>

<p>现在的逻辑是index.js引入index.css，index.css去引入avatar.css，在这个打包的过程中，css-loader帮我们干了一件什么样的事情呢？css-loader会帮我们分析出几个css之间的关系，最终把这些css文件合并成一段css。在得到css-loader生成的内容之后，style-loader会把这段内容挂载到页面的header部分。所以需要css-loader配合style-loader一起来使用。</p>
<p>假设我在项目中不使用css，使用less,sass比较新潮的css文件，要怎么写呢,把index.css改成index.scss</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install style-loader css-loader -D</span><br></pre></td></tr></table></figure>

<p>index.scss</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">body&#123;</span><br><span class="line">　　.avatar &#123;</span><br><span class="line">　　　　width: 150px;</span><br><span class="line">　　　　height: 150px;</span><br><span class="line">　　&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个时候webpack肯定不知道scss文件，这个时候我们配置一下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// 打包模块不知道该怎么办，就去模块配置里面该怎么办</span><br><span class="line">module: &#123;</span><br><span class="line">　　// 规则</span><br><span class="line">　　rules: [&#123;</span><br><span class="line">　　　　// 假设是以css结尾的，我需要一个load帮助我们去打包</span><br><span class="line">　　　　<span class="built_in">test</span>: /\.scss$/,</span><br><span class="line">　　　　// 需要两个loader，所以不能是个对象，需要是个数组</span><br><span class="line">　　　　use: [<span class="string">'style-loader'</span>,<span class="string">'css-loader'</span>]</span><br><span class="line">　　&#125;]</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>再打包，好像打包成功了，但是页面刷新，页面样式没有了。所以当我们用scss的时候，还需要借助其它loader把scss的语法翻译成css的语法。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install sass-loader node-sass －D</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// 打包模块不知道该怎么办，就去模块配置里面该怎么办</span><br><span class="line">module: &#123;</span><br><span class="line">　　// 规则</span><br><span class="line">　　rules: [&#123;</span><br><span class="line">　　　　// 假设是以css结尾的，我需要一个load帮助我们去打包</span><br><span class="line">　　　　<span class="built_in">test</span>: /\.scss$/,</span><br><span class="line">　　　　// 需要两个loader，所以不能是个对象，需要是个数组</span><br><span class="line">　　　　use: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>, <span class="string">'sass-loader'</span>]</span><br><span class="line">　　&#125;]</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>这样，再运行的时候，scss生效了。那么在这个配置中，已经有三个loader了，在webpack的配置里loader是有先后顺序的。loader的执行顺序是从下到上，从右到左，所以当我们去执行scss文件的时候，首先会执行sass-loader。对scss代码进行翻译，翻译成css之后，给到css-loader，然后都处理好后，再给style-loader，挂载到页面。</p>
<p>这里再提一个postcss-loader。这个loader的作用是添加前缀，添加什么前缀呢，浏览器的前缀，我们看一下，<br>index.css</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">body&#123;</span><br><span class="line">　　.avatar &#123;</span><br><span class="line">　　　　width: 150px;</span><br><span class="line">　　　　height: 150px;</span><br><span class="line">　　　　transform: translate(100px, 100px)</span><br><span class="line">　　&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>首先对postcss-loader进行安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -D postcss-loader</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// 打包模块不知道该怎么办，就去模块配置里面该怎么办</span><br><span class="line">module: &#123;</span><br><span class="line">　　// 规则</span><br><span class="line">　　rules: [&#123;</span><br><span class="line">　　　　// 假设是以css结尾的，我需要一个load帮助我们去打包</span><br><span class="line">　　　　<span class="built_in">test</span>: /\.scss$/,</span><br><span class="line">　　　　// 需要两个loader，所以不能是个对象，需要是个数组</span><br><span class="line">　　　　use: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>, <span class="string">'sass-loader'</span>, <span class="string">'postcss-loader]</span></span><br><span class="line"><span class="string">　　&#125;]</span></span><br><span class="line"><span class="string">&#125;,</span></span><br></pre></td></tr></table></figure>

<p>再安装一个</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install autoprefixer -D</span><br></pre></td></tr></table></figure>

<p>再新建一个文件，postcss.config.js</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">　　plugins: [</span><br><span class="line">　　　　require(<span class="string">'autoprefixer'</span>)</span><br><span class="line">　　]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这样就配置好了postcss-loader的一个插件，然后进行打包</p>
<p><img src="/images/5-1.png" alt></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/08/28/webpack系列/5使用loader打包静态文件/5使用loader打包静态文件-样式2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="qicainiao">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="qicainiao's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/28/webpack系列/5使用loader打包静态文件/5使用loader打包静态文件-样式2/" itemprop="url">webpack系列-5使用loader打包静态文件－样式2</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-08-28T13:17:15+08:00">
                2019-08-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>这篇我们了解下css-loader常用的配置项，要配置的话，use里面就不再是一个字符串了</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// 打包模块不知道该怎么办，就去模块配置里面该怎么办</span><br><span class="line">module: &#123;</span><br><span class="line">　　// 规则</span><br><span class="line">　　rules: [&#123;</span><br><span class="line">　　　　// 假设是以css结尾的，我需要一个load帮助我们去打包</span><br><span class="line">　　　　<span class="built_in">test</span>: /\.scss$/,</span><br><span class="line">　　　　// 需要两个loader，所以不能是个对象，需要是个数组</span><br><span class="line">　　　　use: [</span><br><span class="line">　　　　　　<span class="string">'style-loader'</span>,</span><br><span class="line">　　　　　　<span class="string">'css-loader'</span>,</span><br><span class="line">　　　　　　<span class="string">'sass-loader'</span>,</span><br><span class="line">　　　　　　<span class="string">'postcss-loader'</span></span><br><span class="line">　　　　]</span><br><span class="line">　　&#125;]</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>改成</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">// 打包模块不知道该怎么办，就去模块配置里面该怎么办</span><br><span class="line">module: &#123;</span><br><span class="line">　　// 规则</span><br><span class="line">　　rules: [&#123;</span><br><span class="line">　　　　// 假设是以css结尾的，我需要一个load帮助我们去打包</span><br><span class="line">　　　　<span class="built_in">test</span>: /\.scss$/,</span><br><span class="line">　　　　// 需要两个loader，所以不能是个对象，需要是个数组</span><br><span class="line">　　　　use: [</span><br><span class="line">　　　　　　<span class="string">'style-loader'</span>,</span><br><span class="line">　　　　　　&#123;</span><br><span class="line">　　　　　　　　loader: <span class="string">'css-loader'</span>,</span><br><span class="line">　　　　　　　　options: &#123;</span><br><span class="line">　　　　　　　　　　importLoaders: 2</span><br><span class="line">　　　　　　　　&#125;</span><br><span class="line">　　　　　　&#125;,</span><br><span class="line">　　　　　　<span class="string">'sass-loader'</span>,</span><br><span class="line">　　　　　　<span class="string">'postcss-loader'</span></span><br><span class="line">　　　　]</span><br><span class="line">　　&#125;]</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>在很多脚手架中，我们都可以看到importLoaders这样的配置项，那他是什么意思呢<br>比如index.scss里面引入了avatar.scss</p>
<p>index.scss</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@import <span class="string">'./avatar.scss'</span>;</span><br><span class="line"></span><br><span class="line">body&#123;</span><br><span class="line">　　.avatar &#123;</span><br><span class="line">　　　　width: 150px;</span><br><span class="line">　　　　height: 150px;</span><br><span class="line">　　　　transform: translate(100px, 100px)</span><br><span class="line">　　&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在index.js里面引入index.scss，webpack在打包的时候，先去执行postcss-loader，然后执行sass-loader，css-loader,style-loader。但是在index.scss里面遇到avatar.scss的时候，就不再去执行postcss-loader了。而是执行sass-loader了，那如果写上这个配置<br>importLoaders: 2<br>那么还会从下到上执行postcss-loader,sass-loader…。所以这个就能保证，我在哪引用都没有问题。</p>
<p>接下来我们了解下css的模块化<br>createAvatar.js</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import avatar from <span class="string">'./avatar.jpg'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">createAvatar</span></span>() &#123;</span><br><span class="line">　　var img = new Image();</span><br><span class="line">　　img.src = avatar;</span><br><span class="line">　　img.classList.add(<span class="string">'avatar'</span>);</span><br><span class="line"></span><br><span class="line">　　var root = document.getElementById(<span class="string">'root'</span>);</span><br><span class="line">　　root.appendChild(img);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> default createAvatar;</span><br></pre></td></tr></table></figure>

<p>index.js</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import avatar from <span class="string">'./avatar.jpg'</span>;</span><br><span class="line">import <span class="string">'./index.scss'</span>;</span><br><span class="line">import createAvatar from <span class="string">'./createAvatar'</span>;</span><br><span class="line"></span><br><span class="line">createAvatar();</span><br><span class="line"></span><br><span class="line">var img = new Image();</span><br><span class="line">img.src = avatar;</span><br><span class="line">img.classList.add(<span class="string">'avatar'</span>);</span><br><span class="line"></span><br><span class="line">var root = document.getElementById(<span class="string">'root'</span>);</span><br><span class="line">root.appendChild(img);</span><br></pre></td></tr></table></figure>

<p>这样我们打包出来，会看到两张图片，而且样式都是一样的。这个我们要说明一个什么问题呢。在index.js里面引入的index.css会作用于当前页面的img标签，还会作用于createAvatar里面的img标签，这么写，这个样式是全局的，这样很容易引起样式冲突的问题。这个时候我们就引入了一个概念，css module的概念，css模块化的概念，什么意思呢，就是这个css样式只作用于当前页面。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// 需要两个loader，所以不能是个对象，需要是个数组</span><br><span class="line">use: [</span><br><span class="line">　　<span class="string">'style-loader'</span>,</span><br><span class="line">　　&#123;</span><br><span class="line">　　　　loader: <span class="string">'css-loader'</span>,</span><br><span class="line">　　　　options: &#123;</span><br><span class="line">　　　　　　importLoaders: 2,</span><br><span class="line">　　　　　　modules: <span class="literal">true</span>  //css module的概念，css模块化的概念，什么意思呢，就是这个css样式只作用于当前页面。</span><br><span class="line">　　　　&#125;</span><br><span class="line">　　&#125;,</span><br><span class="line">　　<span class="string">'sass-loader'</span>,</span><br><span class="line">　　<span class="string">'postcss-loader'</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>加一个modules的配置，在引入css的地方改成这样<br>index.js</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import avatar from <span class="string">'./avatar.jpg'</span>;</span><br><span class="line">import style from <span class="string">'./index.scss'</span>;</span><br><span class="line">import createAvatar from <span class="string">'./createAvatar'</span>;</span><br><span class="line"></span><br><span class="line">createAvatar();</span><br><span class="line"></span><br><span class="line">var img = new Image();</span><br><span class="line">img.src = avatar;</span><br><span class="line">img.classList.add(style.avatar);</span><br><span class="line"></span><br><span class="line">var root = document.getElementById(<span class="string">'root'</span>);</span><br><span class="line">root.appendChild(img);</span><br></pre></td></tr></table></figure>

<p>打包运行会发现一个是什么样式都没有，一个是有样式的，这样就能保证只有这个文件有对应的样式。如果想要createAvatar也有样式，那么在createAvatar里面也引入</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">import avatar from <span class="string">'./avatar.jpg'</span>;</span><br><span class="line">import style from <span class="string">'./index.scss'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">createAvatar</span></span>() &#123;</span><br><span class="line">　　var img = new Image();</span><br><span class="line">　　img.src = avatar;</span><br><span class="line">　　img.classList.add(style.avatar);</span><br><span class="line"></span><br><span class="line">　　var root = document.getElementById(<span class="string">'root'</span>);</span><br><span class="line">　　root.appendChild(img);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> default createAvatar;</span><br></pre></td></tr></table></figure>

<p>这样又有样式了，这样带来的语法好处是，我这个文件的样式和其它文件的样式不会有耦合，冲突，相对独立。</p>
<p>那么如何使用webpack,打包字体文件,src目录下一个font文件夹，放着字体的格式<br>index.js</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var root = document.getElementById(<span class="string">'root'</span>);</span><br><span class="line">import <span class="string">'./index.scss'</span>;</span><br><span class="line"></span><br><span class="line">root.innerHTML = <span class="string">'&lt;div class="iconfont iconfangdajing"&gt;abc&lt;/div&gt;'</span>;</span><br></pre></td></tr></table></figure>

<p>index.scss</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">@font-face &#123;font-family: <span class="string">"iconfont"</span>;</span><br><span class="line">　　src: url(<span class="string">'./font/iconfont.eot?t=1555804223122'</span>); /* IE9 */</span><br><span class="line">　　src: url(<span class="string">'./font/iconfont.eot?t=1555804223122#iefix'</span>) format(<span class="string">'embedded-opentype'</span>), /* IE6-IE8 */</span><br><span class="line">　　url(<span class="string">'data:application/x-font-woff2;charset=utf-8;base64,d09GMgABAAAAAASYAAsAAAAACSgAAARLAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHEIGVgCDMgqFSIRjATYCJAMUCwwABCAFhG0HRRvsB8gehXEbHUKqr74VirOKgNrvtydP5j7iSZJq9+kkQsQThEJo0AKdUkSzl/DPctrYLiZcQvcIkgKDoUCBteuSI8cHnPSAfsDwA8IXICcBAsD+uHf6V+eBzWdZLmMu25uKBmA0gQIaY3IBZekAKeeW4bWL1WEeJ6CYNAJ2UFhOgZcMjwsIlwJvAq+ETq4gB62yLliaIdyBuzbOxi/h1vt8+LeRF4iqBHjq4XGBFbK//F7WEA6XQ7ODAH84C4RVJCwBmXBVaLtEBIElhKL9zs0OULSi+DXyPPB54ssalwtdtCFFIUGiPMyfF2rAsh4g7QQzX34Wk8hXIK9InghMEj81gmuRVc6Sgn58grACWDHuyeKB36IZ1AeovLz8lVrCN1ytVYyhDt+Gx1sURtHY3RfWeYdh4nGO2zXskTtyLow7PnoXu/PMFPS8fZueezcLLZy73Tk+n8Nych7uzh2tglFRii5lQ+OiCMWKoHrTQeVcgBIUx8qcK5iTZZ2KOen0gS3g2KqcexLD2DkBiwLZxZv96YVL/KgFLMU2zVnkDGS3zx260LGgRDJHldZLPn6xMyAzrrcu4Khz/TMWOqRdgGRxhF3SF+Qt3Oi/MWTRtm2bAjYFL9zaoiveTb/Q37Hgz6GGhntGew4+88CBmXj2FPxS9mG3v3/dDjflrf3Tl6h0NZoKaXtqNC1DxCx8/smT8wnCdjj2tvNOnpqPZ9mG3tZolobEhSQ8+k5M2717GhITYMWn4RHHZcMzwDGu6PqQ/OtI4zLn3enMrKLxXLOQedftT6ZdPp1sxNxzDOJQRlC3KMuyU5+2svLFYP8/IQM/DYyAs2qvQj7EOD2lgGdoPnfBDGNUjDOyoT6SKfScrco/ezYqNiZftTQwLwleInePz2j0WKLO//qZ1jGXLB/68CVPZXb58PndiH+XXMP+f0PaB7ldtpidp56ljl9C8Rd3rqlOGOq1aKWbHR/iGfek7mHEQ3amxnMJJAN0j6djKcdDXSiEnqZ9BP4Dfcf9rU9imzb9m5fSDeD10fUsKOg6MqQbgL9ArjH/d+E3LMu6EOurrBZbPDVUOeV5a7laXcFP4hpyfxjHKIgsQSvyAaLGBCStKTSTlqDSsQW11jYUi4pWdwyTEEL2BhZMRxAM2A1RnwdIBlxGM+keVMa8g9pABBRHwXfLjpkERZ6ETDKykuZxpGARezlqlBV+ei3iR3WbpLjQozBIsgtuMsYQnQ4XoV4kDTHDPpqPlWWO5CSxhyxEp6HubpG0SWInssiGDlm2pRqNXNGdDBaxBxT2SRATGWJFMhuHJLAQ9eKc2jJF5v21EN4o3UykipIaKwOR2Amdk2IYRDdAi2S9jUoupbfdaLxYMhnHjuJIRD1IhWBBuklARLIVD+qEWMgMOjr4bFIZmWpcU5lhekXPPW6DAl9RBRwjMDfMHfOAfG0TehWcqZe3mjoFJw/PMeFmAQAA'</span>) format(<span class="string">'woff2'</span>),</span><br><span class="line">　　url(<span class="string">'./font/iconfont.woff?t=1555804223122'</span>) format(<span class="string">'woff'</span>),</span><br><span class="line">　　url(<span class="string">'./font/iconfont.ttf?t=1555804223122'</span>) format(<span class="string">'truetype'</span>), /* chrome, firefox, opera, Safari, Android, iOS 4.2+ */</span><br><span class="line">　　url(<span class="string">'./font/iconfont.svg?t=1555804223122#iconfont'</span>) format(<span class="string">'svg'</span>); /* iOS 4.1- */</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.iconfont &#123;</span><br><span class="line">　　font-family: <span class="string">"iconfont"</span> !important;</span><br><span class="line">　　font-size: 16px;</span><br><span class="line">　　font-style: normal;</span><br><span class="line">　　-webkit-font-smoothing: antialiased;</span><br><span class="line">　　-moz-osx-font-smoothing: grayscale;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.iconspin:before &#123;</span><br><span class="line">　　content: <span class="string">"\e851"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.iconfangdajing:before &#123;</span><br><span class="line">　　content: <span class="string">"\e614"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.iconAa:before &#123;</span><br><span class="line">　　content: <span class="string">"\e636"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.iconbi:before &#123;</span><br><span class="line">　　content: <span class="string">"\e617"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这样理论上没有什么问题，运行 npm run bundle。发现报错了，报什么错呢</p>
<p><img src="/images/5-2.png" alt></p>
<p>如图，他说字体不知道如何打包，这是为什么呢，在执行引入字体文件的时候，webpack不知道如何打包，这个时候借助于file-loader打包</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">module: &#123;</span><br><span class="line">　　rules: [&#123;</span><br><span class="line">　　　　test: /\.eot|ttf|svg|woff$/,</span><br><span class="line">　　　　use: &#123;</span><br><span class="line">　　　　　　loader: &apos;file-loader&apos;</span><br><span class="line">　　　　&#125;</span><br><span class="line">　　&#125;]</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>再重新运行npm run bundle，就没有报错了，页面上对应的字体内容也显示出来了。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">qicainiao</p>
              <p class="site-description motion-element" itemprop="description">Hello World!</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">25</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">qicainiao</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
